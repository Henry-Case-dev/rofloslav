# Rofloslav Bot - –û—Å—Ç—Ä–æ—É–º–Ω—ã–π Telegram-–±–æ—Ç –Ω–∞ Go –∏ Gemini

–≠—Ç–æ Telegram-–±–æ—Ç, –Ω–∞–ø–∏—Å–∞–Ω–Ω—ã–π –Ω–∞ Go, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Google Gemini API –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –æ—Ç–≤–µ—Ç–æ–≤ –≤ –≥—Ä—É–ø–ø–æ–≤—ã—Ö —á–∞—Ç–∞—Ö. –ë–æ—Ç —Å–ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω –±—ã—Ç—å –æ—Å—Ç—Ä–æ—É–º–Ω—ã–º, –∏—Ä–æ–Ω–∏—á–Ω—ã–º –∏ –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º –∫ —Å—Ç–∏–ª—é –æ–±—â–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —á–∞—Ç–∞.

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

*   **–£—á–∞—Å—Ç–∏–µ –≤ –±–µ—Å–µ–¥–µ:** –ë–æ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ—Ç–≤–µ—á–∞–µ—Ç –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –∑–∞–¥–∞–Ω–Ω—ã–º "—Ö–∞—Ä–∞–∫—Ç–µ—Ä–æ–º" (–æ—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–º–ø—Ç –≤ `.env`).
*   **–ü—Ä—è–º—ã–µ –æ—Ç–≤–µ—Ç—ã:** –†–µ–∞–≥–∏—Ä—É–µ—Ç –Ω–∞ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è (@botname) –∏–ª–∏ –æ—Ç–≤–µ—Ç—ã –Ω–∞ —Å–≤–æ–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Å–∞—Ä–∫–∞—Å—Ç–∏—á–µ—Å–∫–æ–π –º–∞–Ω–µ—Ä–µ (–ø—Ä–æ–º–ø—Ç `DIRECT_PROMPT`).
*   **–¢–µ–º–∞ –¥–Ω—è:** –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é –ø—Ä–æ–≤–æ–∫–∞—Ü–∏–æ–Ω–Ω—É—é —Ç–µ–º—É –¥–ª—è –æ–±—Å—É–∂–¥–µ–Ω–∏—è (–ø—Ä–æ–º–ø—Ç `DAILY_TAKE_PROMPT`, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–µ –≤—Ä–µ–º—è).
*   **–°–∞–º–º–∞—Ä–∏ —á–∞—Ç–∞:** –°–æ–∑–¥–∞–µ—Ç –∫—Ä–∞—Ç–∫–æ–µ –∏–∑–ª–æ–∂–µ–Ω–∏–µ –¥–∏–∞–ª–æ–≥–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 24 —á–∞—Å–∞ –ø–æ –∫–æ–º–∞–Ω–¥–µ `/summary` –∏–ª–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å –∑–∞–¥–∞–Ω–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º (–ø—Ä–æ–º–ø—Ç `SUMMARY_PROMPT`).
*   **–ê–Ω–∞–ª–∏–∑ "—Å—Ä–∞—á–µ–π":**
    *   –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –Ω–∞—á–∞–ª–æ —Å–ø–æ—Ä–æ–≤/–∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –ø–æ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º, –æ—Ç–≤–µ—Ç–∞–º –∏–ª–∏ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è–º (–ø—Ä–æ–º–ø—Ç `SRACH_WARNING_PROMPT`).
    *   –ü—ã—Ç–∞–µ—Ç—Å—è –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≤–µ—Ä—à–∏–≤—à–∏–π—Å—è —Å–ø–æ—Ä, –≤—ã–¥–µ–ª–∏—Ç—å —Å—Ç–æ—Ä–æ–Ω—ã, –∞—Ä–≥—É–º–µ–Ω—Ç—ã –∏ –≤—ã–Ω–µ—Å—Ç–∏ –≤–µ—Ä–¥–∏–∫—Ç (–ø—Ä–æ–º–ø—Ç `SRACH_ANALYSIS_PROMPT`).
    *   –ò—Å–ø–æ–ª—å–∑—É–µ—Ç LLM –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–Ω–æ—Å—Ç—å –∫ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É (–ø—Ä–æ–º–ø—Ç `SRACH_CONFIRM_PROMPT`).
*   **–ù–∞—Å—Ç—Ä–æ–π–∫–∞:** –ü–æ–∑–≤–æ–ª—è–µ—Ç –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã `/settings` (–∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –æ—Ç–≤–µ—Ç–æ–≤, –≤—Ä–µ–º—è —Ç–µ–º—ã –¥–Ω—è, –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å–∞–º–º–∞—Ä–∏, –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ —Å—Ä–∞—á–µ–π).
*   **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏:** –°–æ—Ö—Ä–∞–Ω—è–µ—Ç –∏—Å—Ç–æ—Ä–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π –≤ —Ñ–∞–π–ª (`/data/chat_<ID>.json`) –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏.

## üõ† –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

*   **–Ø–∑—ã–∫:** Go (Golang)
*   **AI –ú–æ–¥–µ–ª—å:** Google Gemini API (—á–µ—Ä–µ–∑ `google/generative-ai-go`) –∏–ª–∏ DeepSeek API (—á–µ—Ä–µ–∑ `sashabaranov/go-openai`)
*   **Telegram API:** –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ `go-telegram-bot-api/v5`
*   **–•—Ä–∞–Ω–∏–ª–∏—â–µ –∏—Å—Ç–æ—Ä–∏–∏:**
    *   –§–∞–π–ª—ã JSON (`/data/chat_<ID>.json`) (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏–ª–∏ –∫–∞–∫ fallback)
    *   PostgreSQL (—á–µ—Ä–µ–∑ `lib/pq`)
    *   MongoDB (—á–µ—Ä–µ–∑ `go.mongodb.org/mongo-driver`)
*   **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** –§–∞–π–ª—ã `.env` –∏ `.env.secrets`, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
*   **–†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ:** Docker (–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–æ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º—É Amvera)

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è AI –∑–∞–¥–∞—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `.env`.
–°–µ–∫—Ä–µ—Ç–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã (`TELEGRAM_TOKEN`, `GEMINI_API_KEY`, `DEEPSEEK_API_KEY`, –ø–∞—Ä–æ–ª–∏ –æ—Ç –ë–î) —Å–ª–µ–¥—É–µ—Ç –ø–æ–º–µ—â–∞—Ç—å –≤ —Ñ–∞–π–ª `.env.secrets`. –≠—Ç–æ—Ç —Ñ–∞–π–ª –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.gitignore` –∏ –Ω–µ –¥–æ–ª–∂–µ–Ω –ø–æ–ø–∞–¥–∞—Ç—å –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env.secrets`, –∑–∞—Ç–µ–º –∏–∑ `.env`, –∏ –≤ –ø–æ—Å–ª–µ–¥–Ω—é—é –æ—á–µ—Ä–µ–¥—å –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ª–µ–≥–∫–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–∏.

–ö–ª—é—á–µ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ:

*   `TELEGRAM_TOKEN`: –¢–æ–∫–µ–Ω –≤–∞—à–µ–≥–æ Telegram –±–æ—Ç–∞.
*   `LLM_PROVIDER`: –í—ã–±–æ—Ä AI –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞ (`gemini` –∏–ª–∏ `deepseek`).
*   `GEMINI_API_KEY`: –ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∫ Google Gemini API (–µ—Å–ª–∏ `LLM_PROVIDER=gemini`).
*   `GEMINI_MODEL_NAME`: –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å Gemini (–Ω–∞–ø—Ä–∏–º–µ—Ä, `gemini-1.5-flash-latest`).
*   `DEEPSEEK_API_KEY`: –ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∫ DeepSeek API (–µ—Å–ª–∏ `LLM_PROVIDER=deepseek`).
*   `DEEPSEEK_MODEL_NAME`: –ò—Å–ø–æ–ª—å–∑—É–µ–º–∞—è –º–æ–¥–µ–ª—å DeepSeek (–Ω–∞–ø—Ä–∏–º–µ—Ä, `deepseek-chat`).
*   `STORAGE_TYPE`: –¢–∏–ø —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –∏—Å—Ç–æ—Ä–∏–∏ (`file`, `postgres` –∏–ª–∏ `mongo`). –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é `postgres`.
*   `POSTGRESQL_HOST`, `POSTGRESQL_PORT`, `POSTGRESQL_USER`, `POSTGRESQL_PASSWORD`, `POSTGRESQL_DBNAME`: –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ PostgreSQL (–µ—Å–ª–∏ `STORAGE_TYPE=postgres`).
*   `MONGODB_URI`: –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ MongoDB (–µ—Å–ª–∏ `STORAGE_TYPE=mongo`).
*   `CONTEXT_WINDOW`: –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π, —Ö—Ä–∞–Ω–∏–º—ã—Ö –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —á–∞—Ç–∞.
*   `TIME_ZONE`: –ß–∞—Å–æ–≤–æ–π –ø–æ—è—Å –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞—á (–Ω–∞–ø—Ä–∏–º–µ—Ä, `Asia/Yekaterinburg`).
*   `DEBUG`: –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –æ—Ç–ª–∞–¥–∫–∏ (`true`/`false`).
*   –ü—Ä–æ–º–ø—Ç—ã (`DEFAULT_PROMPT`, `DIRECT_PROMPT`, `DAILY_TAKE_PROMPT`, `SUMMARY_PROMPT`, `SRACH_*_PROMPT`): –û–ø—Ä–µ–¥–µ–ª—è—é—Ç –ø–æ–≤–µ–¥–µ–Ω–∏–µ AI –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö.

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

–ü—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ Docker-–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ, –≤ —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ Amvera.

1.  –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª—ã `.env` –∏ `.env.secrets` —Å –≤–∞—à–∏–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∏ —Ç–æ–∫–µ–Ω–∞–º–∏.
2.  –°–æ–±–µ—Ä–∏—Ç–µ Docker-–æ–±—Ä–∞–∑: `docker build -t rofloslav-bot .`
3.  –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ Amvera, –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∑–∞–ø—É—Å–∫–∞ –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –≤ `amvera.yml`. –õ–æ–∫–∞–ª—å–Ω–æ –º–æ–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫:
    ```bash
    # –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–æ–∑–¥–∞–Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—è data –¥–ª—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
    mkdir data
    docker run -d --env-file .env --env-file .env.secrets -p 8080:80 -v ./data:/data --name rofloslav rofloslav-bot
    ```

## üí° –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

*   –ë–æ–ª–µ–µ —Ç–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ–ª–µ–π –ø—Ä–∏ —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è Gemini.
*   –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–æ–≤ (—Ç–µ–π–∫, —Å–∞–º–º–∞—Ä–∏) –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞.
*   –£–ª—É—á—à–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∏ –∞–Ω–∞–ª–∏–∑–∞ —Å—Ä–∞—á–µ–π.
*   –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–æ–ª—å—à–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–æ–º–∞–Ω–¥ –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫.
*   –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∫–æ–¥–∞.